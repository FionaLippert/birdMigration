/home/flippert/.conda/envs/birds/bin/python
normalize features
load training data
Processing...
/scratch/data/preprocessed/1H/voronoi_dummy_radars=0_exclude=[]/radar/fall/2016
number of nans:  870
max bird measurement 9938497.9440479
Use Voronoi tessellation
input col birds_from_buffer
55990 870
birds_from_buffer
bird scale = 9938497.9440479
compute fluxes
/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/birds-0.1.0-py3.9.egg/birds/dataloader.py:467: RuntimeWarning: invalid value encountered in remainder
  dd_interp = ((dd_i + 360) % 360 + (dd_j + 360) % 360) / 2
/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/birds-0.1.0-py3.9.egg/birds/dataloader.py:482: RuntimeWarning: invalid value encountered in remainder
  data['direction'] = (data['direction'] + 360) % 360
number of sequences = 2480
discarded 0 sequences due to missing data
Done!
Processing...
/scratch/data/preprocessed/1H/voronoi_dummy_radars=0_exclude=[]/radar/fall/2017
number of nans:  8169
max bird measurement 9580697.41157437
Use Voronoi tessellation
input col birds_from_buffer
55990 8169
birds_from_buffer
bird scale = 9938497.9440479
compute fluxes
number of sequences = 1936
discarded 544 sequences due to missing data
Done!
training set size = 4416
loaded training data
load val data
Processing...
/scratch/data/preprocessed/1H/voronoi_dummy_radars=0_exclude=[]/radar/fall/2015
number of nans:  228
max bird measurement 12157881.069388226
Use Voronoi tessellation
input col birds_from_buffer
55990 228
birds_from_buffer
bird scale = 9938497.9440479
compute fluxes
number of sequences = 104
discarded 0 sequences due to missing data
Done!
loaded val data
----------------------------------------
hyperparameter settings: {'n_hidden': 128, 'n_fc_layers': 2, 'n_fc_layers_fluxmlp': 2, 'n_hidden_fluxmlp': 128, 'n_lstm_layers': 1, 'dropout_p': 0.25, 'lr': 0.0001, 'lr_decay': 100, 'teacher_forcing_gamma': 0.95, 'conservation_constraint': 0.0}
train model [trial 0]
['u', 'v', 'cc', 'tp', 'sp', 't2m', 'sshf']
epoch 1: loss = 0.00012843476005062
epoch 1: val loss = 2.7627342205960304e-05
best model so far; save to disk ...
epoch 2: loss = 8.234912202721611e-05
epoch 2: val loss = 2.8288674002396874e-05
epoch 3: loss = 8.012564072043256e-05
epoch 3: val loss = 3.422292502364144e-05
epoch 4: loss = 7.829274107800003e-05
epoch 4: val loss = 3.408818884054199e-05
epoch 5: loss = 7.773167808583744e-05
epoch 5: val loss = 3.0708684789715335e-05
epoch 6: loss = 7.854407222970374e-05
epoch 6: val loss = 3.6875524529023096e-05
epoch 7: loss = 7.746531565171209e-05
epoch 7: val loss = 3.1941799534251913e-05
epoch 8: loss = 7.989024447288189e-05
epoch 8: val loss = 3.565218867151998e-05
epoch 9: loss = 8.064301492118929e-05
epoch 9: val loss = 3.6641158658312634e-05
epoch 10: loss = 7.995067732140441e-05
epoch 10: val loss = 3.667574128485285e-05
epoch 11: loss = 8.037475139668703e-05
epoch 11: val loss = 4.15939575759694e-05
epoch 12: loss = 8.038301727829584e-05
epoch 12: val loss = 4.2941919673467055e-05
epoch 13: loss = 8.240201631625504e-05
epoch 13: val loss = 3.226896660635248e-05
epoch 14: loss = 8.311624087764214e-05
epoch 14: val loss = 3.426243347348645e-05
epoch 15: loss = 8.346633554623395e-05
epoch 15: val loss = 2.960267011076212e-05
epoch 16: loss = 8.466555104407578e-05
epoch 16: val loss = 3.555252988007851e-05
epoch 17: loss = 8.4285323158905e-05
epoch 17: val loss = 3.7081310438225046e-05
epoch 18: loss = 8.49463437181606e-05
epoch 18: val loss = 3.8329748349497095e-05
epoch 19: loss = 8.454267185010599e-05
epoch 19: val loss = 3.996111627202481e-05
epoch 20: loss = 8.51288872090795e-05
epoch 20: val loss = 3.7981822970323265e-05
epoch 21: loss = 8.557255259805422e-05
epoch 21: val loss = 3.704778282553889e-05
epoch 22: loss = 8.524205742067758e-05
epoch 22: val loss = 4.6721328544663265e-05
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 7737329 ON r30n3 CANCELLED AT 2021-06-08T17:20:25 ***
slurmstepd: error: *** STEP 7737329.0 ON r30n3 CANCELLED AT 2021-06-08T17:20:25 ***

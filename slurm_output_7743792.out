/home/flippert/.conda/envs/birds/bin/python
normalize features
load training data
Processing...
/scratch/data/preprocessed/1H/voronoi_dummy_radars=15_exclude=[]/radar/fall/2016
number of nans:  39045
max bird measurement 6549825.8914035065
Use Voronoi tessellation
input col birds_from_buffer
94165 39045
birds_from_buffer
bird scale = 6549825.8914035065
compute fluxes
/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/birds-0.1.0-py3.9.egg/birds/dataloader.py:467: RuntimeWarning: invalid value encountered in remainder
  dd_interp = ((dd_i + 360) % 360 + (dd_j + 360) % 360) / 2
/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/birds-0.1.0-py3.9.egg/birds/dataloader.py:482: RuntimeWarning: invalid value encountered in remainder
  data['direction'] = (data['direction'] + 360) % 360
number of sequences = 2480
discarded 0 sequences due to missing data
Done!
Processing...
/scratch/data/preprocessed/1H/voronoi_dummy_radars=15_exclude=[]/radar/fall/2017
number of nans:  46344
max bird measurement 5724992.122257813
Use Voronoi tessellation
input col birds_from_buffer
94165 46344
birds_from_buffer
bird scale = 6549825.8914035065
compute fluxes
number of sequences = 1989
discarded 491 sequences due to missing data
Done!
training set size = 4469
loaded training data
load val data
Processing...
/scratch/data/preprocessed/1H/voronoi_dummy_radars=15_exclude=[]/radar/fall/2015
number of nans:  38403
max bird measurement 7336596.093851312
Use Voronoi tessellation
input col birds_from_buffer
94165 38403
birds_from_buffer
bird scale = 6549825.8914035065
compute fluxes
number of sequences = 104
discarded 0 sequences due to missing data
Done!
loaded val data
----------------------------------------
hyperparameter settings: {'n_hidden': 64, 'n_fc_layers': 2, 'n_fc_layers_fluxmlp': 2, 'n_hidden_fluxmlp': 64, 'n_lstm_layers': 1, 'dropout_p': 0.25, 'lr': 0.0001, 'lr_decay': 100, 'teacher_forcing_gamma': 0.95, 'conservation_constraint': 0.1}
train model [trial 0]
['u', 'v', 'cc', 'tp', 'sp', 't2m', 'sshf']
epoch 1: loss = nan
epoch 1: val loss = 0.0
best model so far; save to disk ...
/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/birds-0.1.0-py3.9.egg/birds/utils.py:45: UserWarning: Data has no positive values, and therefore cannot be log-scaled.
epoch 2: loss = nan
epoch 2: val loss = 0.0
best model so far; save to disk ...
/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/birds-0.1.0-py3.9.egg/birds/utils.py:45: UserWarning: Data has no positive values, and therefore cannot be log-scaled.
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 7743792 ON r30n7 CANCELLED AT 2021-06-08T14:30:08 ***

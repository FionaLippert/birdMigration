/home/flippert/.conda/envs/birds/bin/python
normalize features
load training data
Processing...
/scratch/data/preprocessed/1H/voronoi_dummy_radars=0_exclude=[]/radar/fall/2016
number of nans:  870
max bird measurement 9938497.9440479
Use Voronoi tessellation
input col birds_from_buffer
55990 870
birds_from_buffer
bird scale = 9938497.9440479
/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/birds-0.1.0-py3.9.egg/birds/dataloader.py:488: UserWarning: indexing with dtype torch.uint8 is now deprecated, please use a dtype torch.bool instead. (Triggered internally at  /opt/conda/conda-bld/pytorch_1607370151529/work/aten/src/ATen/native/IndexingUtils.h:25.)
  data['speed'][np.isnan(data['speed'])] = -1
/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/birds-0.1.0-py3.9.egg/birds/dataloader.py:489: UserWarning: indexing with dtype torch.uint8 is now deprecated, please use a dtype torch.bool instead. (Triggered internally at  /opt/conda/conda-bld/pytorch_1607370151529/work/aten/src/ATen/native/IndexingUtils.h:25.)
  data['bird_uv'][np.isnan(data['bird_uv'])] = 0 #TODO necessary?
/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/birds-0.1.0-py3.9.egg/birds/dataloader.py:527: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  speeds=torch.tensor(data['speed'][:, :, nidx], dtype=torch.float),
/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/birds-0.1.0-py3.9.egg/birds/dataloader.py:528: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bird_uv=torch.tensor(data['bird_uv'][..., nidx], dtype=torch.float))
number of sequences = 105
discarded 0 sequences due to missing data
Done!
Processing...
/scratch/data/preprocessed/1H/voronoi_dummy_radars=0_exclude=[]/radar/fall/2017
number of nans:  8169
max bird measurement 9580697.41157437
Use Voronoi tessellation
input col birds_from_buffer
55990 8169
birds_from_buffer
bird scale = 9938497.9440479
number of sequences = 82
discarded 23 sequences due to missing data
Done!
training set size = 187
loaded training data
load val data
Processing...
/scratch/data/preprocessed/1H/voronoi_dummy_radars=0_exclude=[]/radar/fall/2015
number of nans:  228
max bird measurement 12157881.069388226
Use Voronoi tessellation
input col birds_from_buffer
55990 228
birds_from_buffer
bird scale = 9938497.9440479
number of sequences = 105
discarded 0 sequences due to missing data
Done!
loaded val data
----------------------------------------
hyperparameter settings: {'n_hidden': 64, 'n_lstm_layers': 1, 'dropout_p': 0.25, 'lr': 0.001, 'lr_decay': 50, 'teacher_forcing_gamma': 0.9, 'predict_delta': True}
train model [trial 0]
['u', 'v', 'cc', 'tp', 'sp', 't2m', 'sshf']
epoch 1: loss = 0.0008867017894903606
epoch 1: val loss = 0.0001950768637470901
best model so far; save to disk ...
epoch 2: loss = 0.00046370853265289235
epoch 2: val loss = 0.00019495552987791598
best model so far; save to disk ...
epoch 3: loss = 0.00047853696195425513
epoch 3: val loss = 0.00022229300520848483
epoch 4: loss = 0.0005141162285273073
epoch 4: val loss = 0.00022603152319788933
epoch 5: loss = 0.0005591868841857213
epoch 5: val loss = 0.00022969314886722714
epoch 6: loss = 0.0005966895542395137
epoch 6: val loss = 0.00022748307674191892
epoch 7: loss = 0.0006498424569767387
epoch 7: val loss = 0.00023357519239652902
epoch 8: loss = 0.0006476128148794346
epoch 8: val loss = 0.00039008521707728505
epoch 9: loss = 0.0007094522659700453
epoch 9: val loss = 0.00027290944126434624
epoch 10: loss = 0.0007578283423846737
epoch 10: val loss = 0.00043871684465557337
----------------------------------------
hyperparameter settings: {'n_hidden': 64, 'n_lstm_layers': 1, 'dropout_p': 0.25, 'lr': 0.0001, 'lr_decay': 50, 'teacher_forcing_gamma': 0.9, 'predict_delta': True}
train model [trial 0]
['u', 'v', 'cc', 'tp', 'sp', 't2m', 'sshf']
epoch 1: loss = 0.00286368546910325
epoch 1: val loss = 0.0002182444150093943
best model so far; save to disk ...
epoch 2: loss = 0.0008599291504846318
epoch 2: val loss = 0.00023195098037831485
epoch 3: loss = 0.000692176957705611
epoch 3: val loss = 0.0002781302318908274
epoch 4: loss = 0.0006825252435167624
epoch 4: val loss = 0.0002939683326985687
epoch 5: loss = 0.0007098336523693842
epoch 5: val loss = 0.00032166167511604726
epoch 6: loss = 0.0007380580312926024
epoch 6: val loss = 0.0003105738142039627
epoch 7: loss = 0.0007557089748371512
epoch 7: val loss = 0.0003076741995755583
epoch 8: loss = 0.0007580059089008121
epoch 8: val loss = 0.000352530216332525
epoch 9: loss = 0.0007975810237542009
epoch 9: val loss = 0.0003495555720292032
epoch 10: loss = 0.0008446273475559802
epoch 10: val loss = 0.00038748234510421753
----------------------------------------
hyperparameter settings: {'n_hidden': 64, 'n_lstm_layers': 1, 'dropout_p': 0.25, 'lr': 1e-05, 'lr_decay': 50, 'teacher_forcing_gamma': 0.9, 'predict_delta': True}
train model [trial 0]
['u', 'v', 'cc', 'tp', 'sp', 't2m', 'sshf']
epoch 1: loss = 0.008454362834420274
epoch 1: val loss = 0.0010463297367095947
best model so far; save to disk ...
epoch 2: loss = 0.005429460365763482
epoch 2: val loss = 0.0005987669574096799
best model so far; save to disk ...
epoch 3: loss = 0.00421720120512985
epoch 3: val loss = 0.0005926822195760906
best model so far; save to disk ...
epoch 4: loss = 0.0035309887461284586
epoch 4: val loss = 0.0005256775766611099
best model so far; save to disk ...
epoch 5: loss = 0.003035632801929459
epoch 5: val loss = 0.0005316133028827608
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 7737037 ON r30n4 CANCELLED AT 2021-06-07T23:18:53 ***
slurmstepd: error: *** STEP 7737037.0 ON r30n4 CANCELLED AT 2021-06-07T23:18:53 ***

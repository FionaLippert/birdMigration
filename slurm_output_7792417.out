drwx------             10 2021/06/24 15:38:39 .
output directory: /home/flippert/birdMigration/checkpoints/boundary_extrapolation_birdflux/array_job_7792417/job_0
normalize features
load year 2016
load year 2017
load data
Processing...
/scratch/data/preprocessed/1H/voronoi_dummy_radars=15_exclude=[]/radar/fall/2016
number of nans:  39045
max bird measurement 6549825.8914035065
Use Voronoi tessellation
input col birds_from_buffer
94165 39045
birds_from_buffer
bird scale = 6549825.8914035065
compute fluxes
number of sequences = 104
discarded 0 sequences due to missing data
Done!
Processing...
/scratch/data/preprocessed/1H/voronoi_dummy_radars=15_exclude=[]/radar/fall/2017
number of nans:  46344
max bird measurement 5724992.122257813
Use Voronoi tessellation
input col birds_from_buffer
94165 46344
birds_from_buffer
bird scale = 6549825.8914035065
compute fluxes
number of sequences = 83
discarded 21 sequences due to missing data
Done!
------------------------------------------------------
-------------------- data sets -----------------------
total number of sequences = 187
number of training sequences = 169
number of validation sequences = 18
169
18
------------------ model settings --------------------
{'name': 'BirdFluxGraphLSTM', 'n_hidden': 128, 'n_fc_layers': 2, 'n_fc_layers_fluxmlp': 2, 'n_hidden_fluxmlp': 64, 'n_lstm_layers': 1, 'dropout_p': 0.25, 'lr': 0.0001, 'lr_decay': 100, 'lr_gamma': 0.1, 'teacher_forcing_gamma': 0.95, 'conservation_constraint': 0.0, 'epochs': 200, 'horizon': 40, 'test_horizon': 64, 'fixed_boundary': False, 'force_zeros': False, 'use_encoder': True, 'context': 24, 'root_transformed_loss': False, 'enforce_conservation': False, 'compute_fluxes': True, 'boundary_constraint_only': True, 'perturbation_std': 0, 'perturbation_mean': 0, 'batch_size': 1, 'boundary_model': 'Extrapolation', 'load_states_from': 'none'}
------------------------------------------------------
train model
['u', 'v', 'cc', 'tp', 'sp', 't2m', 'sshf']
model on GPU? True
epoch 1: loss = 0.001993730360901771
epoch 1: val loss = 0.014554506167769432
best model so far; save to disk ...
epoch 2: loss = 0.0004350566316844438
epoch 2: val loss = 0.008059456944465637
best model so far; save to disk ...
flush log
done
/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/birds-0.1.0-py3.9.egg/birds/dataloader.py:492: RuntimeWarning: invalid value encountered in remainder
  dd_interp = ((dd_i + 360) % 360 + (dd_j + 360) % 360) / 2
/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/birds-0.1.0-py3.9.egg/birds/dataloader.py:507: RuntimeWarning: invalid value encountered in remainder
  data['direction'] = (data['direction'] + 360) % 360
[W python_anomaly_mode.cpp:104] Warning: Error detected in AddBackward0. Traceback of forward call that caused the error:
  File "/home/flippert/birdMigration/scripts/run_2.py", line 39, in <module>
    run()
  File "/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/hydra/main.py", line 32, in decorated_main
    _run_hydra(
  File "/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/hydra/_internal/utils.py", line 346, in _run_hydra
    run_and_report(
  File "/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/hydra/_internal/utils.py", line 198, in run_and_report
    return func()
  File "/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/hydra/_internal/utils.py", line 347, in <lambda>
    lambda: hydra.run(
  File "/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 107, in run
    return run_job(
  File "/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/hydra/core/utils.py", line 127, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/flippert/birdMigration/scripts/run_2.py", line 29, in run
    run_NNs_2.train(cfg, out, log)
  File "/home/flippert/birdMigration/scripts/run_NNs_2.py", line 161, in train
    loss = train_fluxes(model, train_loader, optimizer, loss_func, device,
  File "/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/birds-0.1.0-py3.9.egg/birds/graphNN.py", line 2994, in train_fluxes
    output = model(data) #.view(-1)
  File "/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/birds-0.1.0-py3.9.egg/birds/graphNN.py", line 1271, in forward
    x, h_t, c_t = self.propagate(edge_index, x=x, coords=coords,
  File "/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/torch_geometric/nn/conv/message_passing.py", line 256, in propagate
    return self.update(out, **update_kwargs)
  File "/home/flippert/.conda/envs/birds/lib/python3.9/site-packages/birds-0.1.0-py3.9.egg/birds/graphNN.py", line 1412, in update
    scores = torch.tanh(enc_states + hidden)
 (function _print_stack)
srun: error: r30n4: task 0: Segmentation fault
srun: Job 7792417 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: error: Unable to create step for job 7792417: Job/step already completing or completed
srun: Job 7792417 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 7792417 step creation still disabled, retrying (Requested nodes are busy)
srun: error: Unable to create step for job 7792417: Job/step already completing or completed
slurmstepd: error: *** JOB 7792417 ON r30n4 CANCELLED AT 2021-06-24T16:39:04 DUE TO TIME LIMIT ***
